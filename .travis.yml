language: generic
dist: trusty
env: CC=clang-4.0 CXX=clang++-4.0 RANLIB=llvm-ranlib-4.0 CFLAGS=" -flto -std=gnu99 " LDFLAGS=" -flto -fuse-ld=gold -Wl,-Wl,-plugin=/usr/lib/llvm-4.0/lib/LLVMgold.so,-plugin-opt=save-temps " LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/lib/llvm-4.0/lib/
install:
  - curl -sSL "http://apt.llvm.org/llvm-snapshot.gpg.key" | sudo -E apt-key add -
  - echo "deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-4.0 main" | sudo tee -a /etc/apt/sources.list > /dev/null
  - sudo apt-get update
  - sudo apt-get install -y llvm-4.0 llvm-4.0-dev clang-4.0
  - wget https://curl.haxx.se/download/curl-7.54.0.tar.gz
  - tar xf curl-7.54.0.tar.gz
  - pushd curl-7.54.0
  - sudo ldconfig
  - sudo ldconfig -p
  - ./configure
  - make
  - file src/.libs/curl
  - ls -lah
  - ls -lah src/.libs
